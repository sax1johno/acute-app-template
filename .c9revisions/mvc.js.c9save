{"ts":1351799545380,"silentsave":true,"restoring":false,"patch":[[{"diffs":[[1,"\r\n/**\r\n * Framework dependencies - required for features.\r\n */\r\n\r\nvar fs = require('fs'), \r\n    express = require('express'),\r\n    vm = require('vm'),\r\n    _ = require('underscore'),\r\n    pkg = require('./package'),\r\n    locales = require('./locales');\r\n    \r\nrequire('coffee-script');\r\n  \r\n// var mongoose = \r\n\r\nvar status = false,\r\n    port = process.env.PORT,\r\n    errors,\r\n    config;\r\n\r\nexports.boot = function(app, completeFn){\r\n//    // console.log(\"Booting Ghiraldi\");\r\n    try {\r\n        bootFramework(app, function() {\r\n            // console.log(\"Framework booted\");\r\n            bootConfig(app, function() {\r\n                // console.log(\"config booted\");\r\n                bootData(app, function() {\r\n                    // console.log(\"data booted\");\r\n                    bootPlugins(app, function() {\r\n                        // console.log(\"Plugins booted\");\r\n                        bootApp(app, function() {\r\n                            // console.log(\"Done booting application\");\r\n                            completeFn({\r\n                                status: true,\r\n                                port: port\r\n                            });\r\n                        });\r\n                    });\r\n                });\r\n            });\r\n        });\r\n    } catch (e) {\r\n        status = false;\r\n        errors = e;\r\n        completeFn({\r\n            status: false,\r\n            errors: e\r\n        });\r\n    }\r\n};\r\n\r\n// App settings and middleware\r\n\r\nfunction bootFramework(app, completeFn) {\r\n  // console.log(\"Booting framework\");\r\n  app.use(express.logger(':method :url :status'));\r\n    \r\n  app.use(express.bodyParser({uploadDir: __dirname + '/public/files'}));\r\n  \r\n  app.use(express.methodOverride());\r\n  app.use(express.cookieParser());\r\n  \r\n  app.use(express.session({ secret: '8y3l138ut13je31r13sad13vs8h3ety3r8t13w8weyhel' }));\r\n  app.use(app.router);\r\n  app.use(express.static(__dirname + '/public'));\r\n  \r\n  app.use(locales.init);\r\n\r\n  // Example 500 page\r\n//  app.use(function(err, req, res, next){\r\n//    res.render('500');\r\n//  });\r\n\r\n  // Example 404 page via simple Connect middleware\r\n//  app.use(function(req, res){\r\n//    res.render('404');\r\n//  });\r\n\r\n  app.set('views', __dirname + '/app/views'); \r\n  app.set('view engine', 'jade');\r\n  app.set('view options', { layout: false });\r\n\r\n//  // Some dynamic view helpers\r\n    app.dynamicHelpers(require(__dirname + '/helpers.js').dynamicHelpers);\r\n//app.dynamicHelpers(require(__dirname + 'locales.js').xlate);\r\n\r\n//  \r\n//  // some static view helpers\r\n    app.helpers(require(__dirname + '/helpers.js').staticHelpers);\r\n    \r\n//    app.helpers(require(__dirname + '/locales.js'));\r\n    completeFn();\r\n}\r\n\r\nfunction bootConfig(app, completeFn) {\r\n  config = require(__dirname + '/config.json');\r\n  \r\n  var environment = process.env.NODE_ENV;\r\n  if (_.isUndefined(environment) || _.isNull(environment)) {\r\n    environment = config.environment;\r\n  }\r\n    \r\n  var appSettings = config[environment];\r\n  config = config[environment];\r\n  \r\n  if (appSettings.port !== null && appSettings.port !== undefined) {\r\n      port = appSettings.port;\r\n  }\r\n  \r\n  if (appSettings.logger !== null && appSettings.logger !== undefined) {\r\n        app.use(express.logger(appSettings.logger));\r\n  }\r\n  if (appSettings.uploadDir !== null && appSettings.uploadDir !== undefined) {\r\n    app.use(express.bodyParser({uploadDir: __dirname + appSettings.uploadDir}));\r\n  }\r\n  \r\n  if (appSettings.sessionSecretSalt !== null && appSettings.sessionSecretSalt !== undefined) {\r\n        app.use(express.session({ secret: appSettings.sessionSecretSalt }));\r\n  }\r\n\r\n  if (appSettings.viewsDir !== null && appSettings.viewsDir !== undefined) {\r\n        app.set('views', __dirname + appSettings.viewsDir); \r\n  }\r\n  \r\n  if (appSettings.viewEngine !== null && appSettings.viewEngine !== undefined) {\r\n        app.set('view engine', appSettings.viewEngine);\r\n  }\r\n\r\n  if (appSettings.dynamicHelpers !== null && appSettings.dynamicHelpers !== undefined) {\r\n    // Some dynamic view helpers\r\n    app.dynamicHelpers(require(__dirname + appSettings.dynamicHelpers));\r\n  }\r\n  \r\n  if (appSettings.helpers !== null && appSettings.helpers !== undefined) {\r\n      // some static view helpers\r\n      app.helpers(require(__dirname + appSettings.helpers));\r\n  }\r\n  completeFn();\r\n}\r\n\r\n/**\r\n * Boots up the framework with this application.\r\n * @param app the application server.\r\n **/\r\nfunction bootApp(app, completeFn) {\r\n    // console.log(\"Booting the app\");\r\n    var basedir = __dirname + '/app';\r\n    try {\r\n            // console.log(\"Booted app data\");\r\n            bootModels(app, basedir, function() {\r\n                // console.log(\"Booted app models\");\r\n                bootControllers(app, basedir, function() {\r\n                    // console.log(\"Booted app controllers\");\r\n                    bootResources(app, basedir, function() {\r\n                        // console.log(\"Booted app resources\");\r\n                        completeFn();\r\n                    });\r\n                });\r\n            });\r\n    } catch (e) {\r\n        errors = e;\r\n        completeFn();\r\n    }\r\n}\r\n\r\n/**\r\n * Boots up the framework with the project plugins.\r\n * @param app the application server.\r\n **/\r\nfunction bootPlugins(app, completeFn) {\r\n    fs.readdir(__dirname + '/plugins', function(err, plugins) {\r\n        if (err) { \r\n            // console.log(\"There was an error: \" + err);\r\n            completeFn(); \r\n        } else if (_.isNull(plugins) || _.isUndefined(plugins)) {\r\n            // console.log(\"No plugins were found\");\r\n            completeFn();\r\n        } else {\r\n            // console.log(\"booting plugins\");\r\n            var pluginIndex = plugins.length;\r\n            // console.log(\"Plugins.length = \" + plugins.length);\r\n            if (plugins.length === 0) {\r\n                // console.log(\"Plugins length was 0 - all done\");\r\n                completeFn();\r\n            } else {\r\n                plugins.forEach(function(plugin) {\r\n                    bootModels(app, __dirname + '/plugins/' + plugin, function() {\r\n                        bootResources(app, __dirname + '/plugins/' + plugin, function() {\r\n                            bootControllers(app, __dirname + '/plugins/' + plugin, function() {\r\n                                pluginIndex--;\r\n                                // console.log(\"Plugin index = \" + pluginIndex);\r\n                                if (pluginIndex <= 0) {\r\n                                    completeFn();\r\n                                }\r\n                            });\r\n                        });\r\n                    });\r\n                });\r\n            }\r\n        }\r\n    });\r\n}\r\n\r\n/** Boots up the framework with the resources for this project.\r\n * @param app the application server.\r\n * @param basedir the base directory for the resources.\r\n **/\r\nfunction bootResources(app, basedir, completeFn) {\r\n    if (locales === null || locales === undefined) {\r\n        locales = {};\r\n    }\r\n    var resourcePath = basedir.match(/\\/[a-zA-Z0-9.\\-]+$/);\r\n    resourcePath = resourcePath.toString().replace(/-.*/, '').replace('/', '');\r\n    fs.readdir(basedir + '/resources', function(err, resourceFiles) {\r\n        if (resourceFiles !== null && resourceFiles !== undefined) {\r\n            var resourceFilesIndex = resourceFiles.length;\r\n            resourceFiles.forEach(function(resource){\r\n                var res = require(basedir + '/resources/' + resource);\r\n                resource = resource.replace('.json', '');\r\n                locales.setLocale(res, resource, resourcePath);\r\n                resourceFilesIndex--;\r\n                if (resourceFilesIndex <= 0) {\r\n                    completeFn();\r\n                }\r\n            });\r\n        } else {\r\n            completeFn();\r\n        }\r\n    });\r\n}\r\n\r\n/**\r\n * Boot up the framework with the models found in basedir.\r\n * @param app the application server.\r\n * @param basedir the base directory for the models.\r\n **/\r\nfunction bootModels(app, basedir, completeFn) {\r\n    fs.readdir(basedir + '/models', function(err, files) {\r\n        if (err) { completeFn(); return; }\r\n        if (_.isNull(files) || _.isUndefined(files)) {\r\n            completeFn();\r\n            return;\r\n        }\r\n        var filesIndex = files.length;\r\n        files.forEach(function(file) {\r\n            filesIndex--;\r\n            fs.stat(basedir + '/models/' + file, function(err, stats) {\r\n                if (stats.isFile()) {\r\n                    bootModel(app, basedir, file);\r\n                }\r\n                if (filesIndex <= 0) {\r\n                    completeFn();\r\n                }\r\n            });\r\n        });\r\n    });\r\n}\r\n\r\n/**\r\n * Boots a model into the application framework.\r\n * @param app the application server.\r\n * @param file the file containing the data model.\r\n **/\r\nfunction bootModel(app, basedir, file) {\r\n    // console.log(\"Booting model \" + basedir + \" - \" + file);\r\n    require(basedir + '/models/' + file);\r\n}\r\n\r\n// Bootstrap controllers\r\n\r\n/**\r\n * Boot up the framework with the controllers found in basedir.\r\n * @param app the application server.\r\n * @param basedir the base directory that contains the controllers\r\n **/\r\nfunction bootControllers(app, basedir, completeFn) {\r\n  fs.readdir(basedir + '/controllers', function(err, files){\r\n    if (err) { completeFn(); return; }\r\n    if (_.isNull(files) || _.isUndefined(files)) {\r\n        completeFn();\r\n        return;\r\n    }\r\n    var filesIndex = files.length\r\n    files.forEach(function(file){\r\n        filesIndex--;\r\n        bootController(app, basedir, file, function() {\r\n            if (filesIndex <= 0) {\r\n                completeFn();\r\n            }\r\n        });\r\n\r\n    });\r\n  });\r\n}\r\n\r\n/**\r\n * Boot data into the framwork using the config.json configuration file.  Currently only supports mongodb\r\n * @param app the application server\r\n **/\r\nfunction bootData(app, completeFn) {\r\n    if (config.data.provider === 'mongodb') {\r\n        var mongoose = require('mongoose');\r\n        var connectionString = \"mongodb://\";\r\n\r\n        if (config.data.host && config.data.database) {\r\n            if (config.data.username && config.data.password) {\r\n                connectionString += config.data.username + \":\" + config.data.password + \"@\"\r\n            }\r\n            connectionString += config.data.host + \"/\" + config.data.database;\r\n            mongoose.connect(connectionString);\r\n//            console.log(\"database = \" + connectionString);\r\n        }\r\n    } else {\r\n        // console.log(\"Provider \" + config.data.provider + \" not supported\");\r\n    }\r\n    completeFn();\r\n}\r\n\r\n/**\r\n * Boot a controller into the framework.\r\n * @param app the application server\r\n * @param file the controller file\r\n **/\r\nfunction bootController(app, basedir, file, completeFn) {\r\n  // console.log(\"Booting controller \" + basedir + \" - \" + file);\r\n  var actions = require(basedir + '/controllers/' + file);\r\n  if (!_.has(actions, 'routes')) {\r\n      completeFn();\r\n      return;\r\n  }\r\n  Object.keys(actions).map(function(action){\r\n    if (action == 'routes') {\r\n        // add some routes from the routes part.\r\n        //actions[action] = routes array.\r\n        var actionsIndex = actions[action].length;\r\n        if (actionsIndex <= 0) {\r\n            completeFn();\r\n        }\r\n        actions[action].forEach(function(route) {\r\n            actionsIndex--;\r\n            var routepath;\r\n            basedir = basedir.match(/\\/[a-zA-Z0-9.\\-]+$/);\r\n            basedir = basedir.toString().replace(/-.*/, '');\r\n            if (basedir.toString().match(/\\/app$/)) {\r\n                routepath = route.route;\r\n            } else {\r\n                routepath = basedir + route.route;\r\n            }\r\n            var fn = routeAction(routepath, route.method);\r\n            switch(route.verb) {\r\n                case 'get':\r\n                    if (route.middleware) {\r\n                        app.get(routepath, route.middleware, route.method);\r\n                    } else {\r\n                        app.get(routepath, route.method);\r\n                    }\r\n                    break;\r\n                case 'put':\r\n                    if (route.middleware) {\r\n                        app.put(routepath, route.middleware, route.method);\r\n                    } else {\r\n                        app.put(routepath, route.method);\r\n                    }\r\n                    break;\r\n                case 'post':\r\n                    if (route.middleware) {\r\n                        app.post(routepath, route.middleware, route.method);\r\n                    } else {\r\n                        app.post(routepath, route.method);\r\n                    }  \r\n                    break;\r\n                case 'del':\r\n                    if (route.middleware) {\r\n                        app.del(routepath, route.middleware, route.method);\r\n                    } else {\r\n                        app.del(routepath, route.method);\r\n                    }                    \r\n                    break;\r\n            }\r\n            // console.log('adding route ' + routepath);\r\n            if (actionsIndex <= 0) {\r\n                // console.log(\"Actions index = 0\");\r\n                completeFn();\r\n            }\r\n        });\r\n    }\r\n  });\r\n}\r\n    \r\n/**\r\n * Allow us to call the route action in the application context.\r\n **/\r\nfunction routeAction(route, fn) {\r\n    return function(req, res, next) {\r\n        fn.apply(this, arguments);\r\n    };\r\n}\r\n\r\n/* Note: the rest of this stuff should go in a library somewhere. */\r\n/**\r\n * Walk a directory tree and return the files in that tree.\r\n **/\r\nvar walk = function(dir, done) {\r\n    var results = [];\r\n    fs.readdir(dir, function(err, list) {\r\n        if (err) return done(err);\r\n        var i = 0;\r\n        (function next() {\r\n            var file = list[i++];\r\n            if (!file) return done(null, results);\r\n            file = dir + '/' + file;\r\n            fs.stat(file, function(err, stat) {\r\n                if (stat && stat.isDirectory()) {\r\n                    walk(file, function(err, res) {\r\n                        results = results.concat(res);\r\n                        next();\r\n                    });\r\n                } else {\r\n                    results.push(file);\r\n                    next();\r\n                }\r\n            });\r\n        })();\r\n    });\r\n};\r\n\r\n"]],"start1":0,"start2":0,"length1":0,"length2":14302}]],"length":14302}
{"contributors":[],"silentsave":false,"ts":1353108875577,"patch":[[{"diffs":[[0,");\r\n"],[-1,"//app.dynamicHelpers(require(__dirname + 'locales.js').xlate);\r\n\r\n//  "],[0,"\r\n//"]],"start1":2429,"start2":2429,"length1":78,"length2":8}]],"length":14232,"saved":false}
{"ts":1353109126402,"patch":[[{"diffs":[[0,"cHelpers);\r\n"],[1,"//app.dynamicHelpers(require(__dirname + 'locales.js').xlate);\r\n\r\n//  "],[0,"\r\n//  // som"]],"start1":2421,"start2":2421,"length1":24,"length2":94},{"diffs":[[0,"\n    });\r\n};"],[-1,"\r\n\r\n"]],"start1":14286,"start2":14286,"length1":16,"length2":12}]],"length":14298,"saved":false}
{"ts":1353109344734,"patch":[[{"diffs":[[0,"c view helpers\r\n"],[1,"//"],[0,"    app.dynamicH"]],"start1":2341,"start2":2341,"length1":32,"length2":34}]],"length":14300,"saved":false}
{"ts":1353109359968,"patch":[[{"diffs":[[0,"c view helpers\r\n"],[1,"//"],[0,"    app.helpers("]],"start1":2524,"start2":2524,"length1":32,"length2":34}]],"length":14302,"saved":false}
{"ts":1353109500563,"patch":[[{"diffs":[[0," completeFn) {\r\n"],[1,"    if (!_.isUndefined(config.data) && !_.isNull(config.data)) {\r\n    "],[0,"    if (config.d"]],"start1":9883,"start2":9883,"length1":32,"length2":102},{"diffs":[[0,"ongodb') {\r\n"],[1,"    "],[0,"        var "]],"start1":10004,"start2":10004,"length1":24,"length2":28},{"diffs":[[0,");\r\n        "],[1," "],[1,"   "],[0,"var connecti"]],"start1":10061,"start2":10061,"length1":24,"length2":28},{"diffs":[[0,"b://\";\r\n"],[-1,"\r\n"],[1,"    \r\n    "],[0,"        "]],"start1":10107,"start2":10107,"length1":18,"length2":26},{"diffs":[[0," {\r\n            "],[1,"    "],[0,"if (config.data."]],"start1":10178,"start2":10178,"length1":32,"length2":36},{"diffs":[[0,"                "],[1," "],[1,"   "],[0,"connectionString"]],"start1":10251,"start2":10251,"length1":32,"length2":36},{"diffs":[[0,"@\"\r\n            "],[1,"   "],[1," "],[0,"}\r\n"],[1,"    "],[0,"            conn"]],"start1":10344,"start2":10344,"length1":35,"length2":43},{"diffs":[[0,"        "],[1," "],[1,"   "],[0,"mongoose"]],"start1":10455,"start2":10455,"length1":16,"length2":20},{"diffs":[[0,"onString);\r\n"],[1,"    "],[0,"//          "]],"start1":10492,"start2":10492,"length1":24,"length2":28},{"diffs":[[0,"onString);\r\n"],[1,"    "],[0,"        }\r\n "]],"start1":10558,"start2":10558,"length1":24,"length2":28},{"diffs":[[0,"         }\r\n"],[1,"    "],[0,"    } else {"]],"start1":10573,"start2":10573,"length1":24,"length2":28},{"diffs":[[0,"      } else {\r\n"],[1,"    "],[0,"        // conso"]],"start1":10587,"start2":10587,"length1":32,"length2":36},{"diffs":[[0,"ted\");\r\n    "],[-1,"}\r\n"],[1,"    }\r\n    "],[0,"    complete"]],"start1":10679,"start2":10679,"length1":27,"length2":35},{"diffs":[[0,"   completeFn();"],[1,"        \r\n    } else {\r\n        completeFn();\r\n    }"],[0,"\r\n}\r\n\r\n/**\r\n * B"]],"start1":10703,"start2":10703,"length1":32,"length2":84}]],"length":14484,"saved":false}
{"ts":1353109559221,"patch":[[{"diffs":[[0,"pported\");\r\n    "],[-1,"    }\r\n"],[0,"        complete"]],"start1":10675,"start2":10675,"length1":39,"length2":32},{"diffs":[[0,"eteFn();"],[1,"\r\n"],[0,"        "],[1,"}"],[0,"\r\n    } "]],"start1":10704,"start2":10704,"length1":24,"length2":27}]],"length":14480,"saved":false}
{"ts":1353109590010,"patch":[[{"diffs":[[0,"b://\";\r\n"],[-1,"    \r\n"],[0,"        "]],"start1":10107,"start2":10107,"length1":22,"length2":16}]],"length":14474,"saved":false}
{"ts":1353109618503,"patch":[[{"diffs":[[0,"onString);\r\n"],[1,"                completeFn();\r\n            } else {\r\n                completeFn();                \r\n"],[0,"            "]],"start1":10552,"start2":10552,"length1":24,"length2":124}]],"length":14574,"saved":false}
{"ts":1353109647264,"patch":[[{"diffs":[[0," {\r\n            "],[-1,"//"],[0,""],[1,""],[0," console.log(\"Fr"]],"start1":526,"start2":526,"length1":34,"length2":32},{"diffs":[[0,"                "],[-1,"//"],[0," console.log(\"co"]],"start1":619,"start2":619,"length1":34,"length2":32},{"diffs":[[0,"                "],[-1,"//"],[0," console.log(\"da"]],"start1":715,"start2":715,"length1":34,"length2":32},{"diffs":[[0,"                "],[-1,"//"],[0," console.log(\"Pl"]],"start1":820,"start2":820,"length1":34,"length2":32},{"diffs":[[0,"                "],[-1,"//"],[0,""],[1,""],[0," console.log(\"Do"]],"start1":932,"start2":932,"length1":34,"length2":32}]],"length":14564,"saved":false}
{"ts":1353109691883,"patch":[[{"diffs":[[0,"pleteFn) {\r\n    "],[-1,"//"],[0," console.log(\"Bo"]],"start1":4436,"start2":4436,"length1":34,"length2":32},{"diffs":[[0,"the app\");\r\n"],[1,""],[0,"    var base"]],"start1":4474,"start2":4474,"length1":24,"length2":24},{"diffs":[[0," {\r\n            "],[-1,"//"],[0," console.log(\"Bo"]],"start1":4532,"start2":4532,"length1":34,"length2":32},{"diffs":[[0,"                "],[-1,"//"],[0," console.log(\"Bo"]],"start1":4633,"start2":4633,"length1":34,"length2":32},{"diffs":[[0,"                "],[-1,"//"],[0," console.log(\"Bo"]],"start1":4749,"start2":4749,"length1":34,"length2":32},{"diffs":[[0,", function() {\r\n"],[1,""],[0,"                "]],"start1":4852,"start2":4852,"length1":32,"length2":32},{"diffs":[[0,"                "],[-1,"//"],[0," console.log(\"Bo"]],"start1":4876,"start2":4876,"length1":34,"length2":32}]],"length":14554,"saved":false}
{"ts":1353109781207,"patch":[[{"diffs":[[0,") { "],[-1,"completeFn(); return; }\r\n       "],[1,"\r\n            completeFn();\r\n        } else"],[0," if "]],"start1":8073,"start2":8073,"length1":40,"length2":51},{"diffs":[[0,"    "],[-1,"    return;\r\n        }\r\n"],[1,"} else if (files.length <= 0) {\r\n            completeFn();\r\n        } else {\r\n    "],[0,"    "]],"start1":8200,"start2":8200,"length1":32,"length2":90},{"diffs":[[0,"h;\r\n        "],[1,"    "],[0,"files.forEac"]],"start1":8322,"start2":8322,"length1":24,"length2":28},{"diffs":[[0," {\r\n            "],[1,"    "],[0,"filesIndex--;\r\n "]],"start1":8366,"start2":8366,"length1":32,"length2":36},{"diffs":[[0,"-;\r\n            "],[1,"  "],[1,"  "],[0,"fs.stat(basedir "]],"start1":8397,"start2":8397,"length1":32,"length2":36},{"diffs":[[0,"                "],[1,"    "],[0,"if (stats.isFile"]],"start1":8478,"start2":8478,"length1":32,"length2":36},{"diffs":[[0,"                "],[1,"   "],[1," "],[0,"bootModel(app, b"]],"start1":8525,"start2":8525,"length1":32,"length2":36},{"diffs":[[0,"asedir, file);\r\n"],[1,"    "],[0,"                "]],"start1":8561,"start2":8561,"length1":32,"length2":36},{"diffs":[[0,"                "],[1,"    "],[0,"if (filesIndex <"]],"start1":8600,"start2":8600,"length1":32,"length2":36},{"diffs":[[0,"                "],[1," "],[1,"   "],[0,"completeFn();\r\n "]],"start1":8648,"start2":8648,"length1":32,"length2":36},{"diffs":[[0,"                "],[-1,"}"],[1,"    }\r\n                });"],[0,"\r\n            })"]],"start1":8683,"start2":8683,"length1":33,"length2":58},{"diffs":[[0,";\r\n        }"],[-1,");"],[0,""],[1,""],[0,"\r\n    });\r\n}"]],"start1":8741,"start2":8741,"length1":26,"length2":24}]],"length":14678,"saved":false}
{"ts":1353109801296,"patch":[[{"diffs":[[0," completeFn();\r\n"],[1,"            console.log(\"err = \" + err);\r\n"],[0,"        } else i"]],"start1":8090,"start2":8090,"length1":32,"length2":74}]],"length":14720,"saved":false}
{"ts":1353109833210,"patch":[[{"diffs":[[0," completeFn();\r\n"],[1,"            console.log(\"files is not defined or null\");\r\n"],[0,"        } else i"]],"start1":8222,"start2":8222,"length1":32,"length2":90},{"diffs":[[0," completeFn();\r\n"],[1,"            console.log(\"No files found\");\r\n"],[0,"        } else {"]],"start1":8348,"start2":8348,"length1":32,"length2":76}]],"length":14822,"saved":false}
{"ts":1353109838605,"patch":[[{"diffs":[[0,"on(file) {\r\n"],[1,"                console.log(file);\r\n"],[0,"            "]],"start1":8502,"start2":8502,"length1":24,"length2":60}]],"length":14858,"saved":false}
{"ts":1353109857722,"patch":[[{"diffs":[[0," completeFn();\r\n"],[1,"//"],[0,"            cons"]],"start1":8090,"start2":8090,"length1":32,"length2":34},{"diffs":[[0,"rr = \" + err);\r\n"],[-1,""],[0,"        } else i"]],"start1":8134,"start2":8134,"length1":32,"length2":32},{"diffs":[[0," completeFn();\r\n"],[1,"//"],[0,"            cons"]],"start1":8224,"start2":8224,"length1":32,"length2":34},{"diffs":[[0,"or null\");\r\n"],[-1,""],[0,"        } el"]],"start1":8288,"start2":8288,"length1":24,"length2":24},{"diffs":[[0," completeFn();\r\n"],[1,"//"],[0,"            cons"]],"start1":8352,"start2":8352,"length1":32,"length2":34},{"diffs":[[0,"files found\");\r\n"],[-1,""],[0,"        } else {"]],"start1":8398,"start2":8398,"length1":32,"length2":32},{"diffs":[[0,"on(file) {\r\n"],[1,"//"],[0,"            "]],"start1":8508,"start2":8508,"length1":24,"length2":26}]],"length":14866,"saved":false}
{"ts":1353110715807,"patch":[[{"diffs":[[0,"r, files){\r\n"],[1,"    "],[0,"    if (err)"]],"start1":9578,"start2":9578,"length1":24,"length2":28},{"diffs":[[0," (err) {"],[1,"\r\n           "],[0," complet"]],"start1":9600,"start2":9600,"length1":16,"length2":29},{"diffs":[[0,"n();"],[-1," return; }\r\n"],[1,"\r\n        } else {\r\n        "],[0,"    if ("],[1,"!"],[0,"_.is"]],"start1":9631,"start2":9631,"length1":28,"length2":45},{"diffs":[[0,"_.isNull(files) "],[-1,"|| "],[1,"&& !"],[0,"_.isUndefined(fi"]],"start1":9672,"start2":9672,"length1":35,"length2":36},{"diffs":[[0,"    "],[-1,"completeFn();\r\n        return;\r\n    }\r\n"],[1,"        if (files.length <= 0) {\r\n                    completeFn();\r\n                } else {\r\n                "],[0,"    "]],"start1":9721,"start2":9721,"length1":47,"length2":119},{"diffs":[[0,"s.length"],[1,";"],[0,"\r\n"],[1,"                "],[0,"    file"]],"start1":9861,"start2":9861,"length1":18,"length2":35},{"diffs":[[0,"ion(file){\r\n"],[1,"                "],[0,"        file"]],"start1":9911,"start2":9911,"length1":24,"length2":40},{"diffs":[[0," filesIndex--;\r\n"],[1,"                "],[0,"        bootCont"]],"start1":9946,"start2":9946,"length1":32,"length2":48},{"diffs":[[0,", function() {\r\n"],[1,"                "],[0,"            if ("]],"start1":10019,"start2":10019,"length1":32,"length2":48},{"diffs":[[0,"                "],[1,"      "],[1,"          "],[0,"completeFn();\r\n "]],"start1":10087,"start2":10087,"length1":32,"length2":48},{"diffs":[[0,"    "],[-1,"}\r\n        });\r\n\r\n    });"],[1,"                }\r\n                        });\r\n                    });\r\n                }\r\n            });        \r\n        } else {\r\n            completeFn();\r\n        }\r\n      }"],[0,"\r\n  "]],"start1":10142,"start2":10142,"length1":33,"length2":188}]],"length":15209,"saved":false}
{"ts":1353110796156,"patch":[[{"diffs":[[0,"       }"],[-1,")"],[0,";       "]],"start1":10243,"start2":10243,"length1":17,"length2":16},{"diffs":[[0,"   }"],[-1," else {\r\n            completeFn();\r\n        }\r\n      }"],[0,"\r\n"],[1,"  "],[0,"  })"]],"start1":10267,"start2":10267,"length1":64,"length2":12}]],"length":15156,"saved":false}
{"contributors":[],"silentsave":false,"ts":1353112059201,"patch":[[{"diffs":[[0,", 'jade');\r\n"],[1,"//"],[0,"  app.set('v"]],"start1":2252,"start2":2252,"length1":24,"length2":26},{"diffs":[[0," completeFn();\r\n"],[1,"                    console.log(\"no files found\");\r\n"],[0,"                "]],"start1":9780,"start2":9780,"length1":32,"length2":84}]],"length":15210,"saved":false}
{"contributors":[],"silentsave":false,"ts":1353112171918,"patch":[[{"diffs":[[0,"\r\n\r\n"],[-1,"  // Example 500 page\r\n//  app.use(function(err, req, res, next){\r\n//    res.render('500');\r\n//  });\r\n\r\n  // Example 404 page via simple Connect middleware\r\n//  app.use(function(req, res){\r\n//    res.render('404');\r\n//  });\r\n\r\n"],[0,"  ap"]],"start1":1950,"start2":1950,"length1":235,"length2":8}]],"length":14983,"saved":false}
{"ts":1353112191580,"patch":[[{"diffs":[[0,"c view helpers\r\n"],[-1,"//"],[0,"    app.dynamicH"]],"start1":2106,"start2":2106,"length1":34,"length2":32},{"diffs":[[0,"elpers\r\n"],[-1,"//"],[0,"    app."],[-1,"helper"],[1,"local"],[0,"s(requir"]],"start1":2295,"start2":2295,"length1":32,"length2":29}]],"length":14978,"saved":false}
{"ts":1353112196557,"patch":[[{"diffs":[[0,"c view helpers\r\n"],[1,"//"],[0,"    app.dynamicH"]],"start1":2106,"start2":2106,"length1":32,"length2":34}]],"length":14980,"saved":false}
{"ts":1353112385671,"patch":[[{"diffs":[[0,"elpers\r\n"],[-1,"//"],[0,"    app."]],"start1":2114,"start2":2114,"length1":18,"length2":16},{"diffs":[[0,".xlate);\r\n\r\n"],[1,"    app.use(function(req, res, next) {\r\n        var dynamicHelpers = require(__dirname + '/helpers.js').dynamicHelpers;\r\n    });\r\n"],[0,"//  \r\n//  //"]],"start1":2252,"start2":2252,"length1":24,"length2":154}]],"length":15108,"saved":false}
{"ts":1353112404779,"patch":[[{"diffs":[[0,"lpers;\r\n"],[1,"        app.locals(dynamicHelpers);\r\n"],[0,"    });\r"]],"start1":2377,"start2":2377,"length1":16,"length2":53}]],"length":15145,"saved":false}
{"ts":1353112417848,"patch":[[{"diffs":[[0,"c view helpers\r\n"],[1,"//"],[0,"    app.dynamicH"]],"start1":2106,"start2":2106,"length1":32,"length2":34}]],"length":15147,"saved":false}
{"ts":1353112470679,"patch":[[{"diffs":[[0,"ers.js')"],[-1,".dynamicHelpers"],[0,";\r\n     "]],"start1":2361,"start2":2361,"length1":31,"length2":16}]],"length":15132,"saved":false}
{"ts":1353112480760,"patch":[[{"diffs":[[0,"    var "],[-1,"dynamicH"],[1,"h"],[0,"elpers ="]],"start1":2310,"start2":2310,"length1":24,"length2":17},{"diffs":[[0,".locals("],[1,"helpers."],[0,"dynamicH"]],"start1":2376,"start2":2376,"length1":16,"length2":24}]],"length":15133,"saved":false}
{"ts":1353112526194,"patch":[[{"diffs":[[0," });\r\n\r\n"],[1,"// TODO: add dynamic and static helpers back into the mix.\r\n"],[0,"//  // S"]],"start1":2080,"start2":2080,"length1":16,"length2":76},{"diffs":[[0,"elpers\r\n"],[-1,""],[0,"//    ap"]],"start1":2174,"start2":2174,"length1":16,"length2":16},{"diffs":[[0,"te);\r\n\r\n"],[1,"//"],[0,"    app."]],"start1":2318,"start2":2318,"length1":16,"length2":18},{"diffs":[[0,", res, next) {\r\n"],[1,"//"],[0,"        var help"]],"start1":2352,"start2":2352,"length1":32,"length2":34},{"diffs":[[0,"pers.js');\r\n"],[1,"//"],[0,"        app."]],"start1":2417,"start2":2417,"length1":24,"length2":26},{"diffs":[[0,"cHelpers);\r\n"],[1,"//"],[0,"    });\r\n// "]],"start1":2464,"start2":2464,"length1":24,"length2":26},{"diffs":[[0,");\r\n"],[1,"//"],[0,"//  \r\n"],[1,"//"],[0,"//  "]],"start1":2483,"start2":2483,"length1":14,"length2":18},{"diffs":[[0,"c view helpers\r\n"],[1,"//"],[0,"    app.locals(r"]],"start1":2514,"start2":2514,"length1":32,"length2":34}]],"length":15207,"saved":false}
{"ts":1353112712404,"patch":[[{"diffs":[[0,"c view helpers\r\n"],[-1,"//"],[0,"    app.locals(r"]],"start1":2514,"start2":2514,"length1":34,"length2":32}]],"length":15205,"saved":false}
{"ts":1353113387725,"patch":[[{"diffs":[[0,"js')"],[-1,".staticHelpers"],[0,");\r\n"]],"start1":2575,"start2":2575,"length1":22,"length2":8}]],"length":15191,"saved":false}
{"ts":1353113447213,"patch":[[{"diffs":[[0,"ngine);\r\n  }\r\n\r\n"],[1,"//"],[0,"  if (appSetting"]],"start1":3871,"start2":3871,"length1":32,"length2":34},{"diffs":[[0,"defined) {\r\n"],[1,"//"],[0,"    // Some "]],"start1":3967,"start2":3967,"length1":24,"length2":26},{"diffs":[[0,"c view helpers\r\n"],[1,"//"],[0,"    app.dynamicH"]],"start1":3999,"start2":3999,"length1":32,"length2":34},{"diffs":[[0,"Helpers));\r\n"],[1,"//"],[0,"  }\r\n"],[1,"//"],[0,"  \r\n"],[1,"//"],[0,"  if (appSet"]],"start1":4079,"start2":4079,"length1":33,"length2":39},{"diffs":[[0,"defined) {\r\n"],[1,"//"],[0,"      // som"]],"start1":4170,"start2":4170,"length1":24,"length2":26},{"diffs":[[0,"ew helpers\r\n"],[1,"//"],[0,"      app.he"]],"start1":4207,"start2":4207,"length1":24,"length2":26},{"diffs":[[0,"helpers));\r\n"],[1,"//"],[0,"  }\r\n  compl"]],"start1":4271,"start2":4271,"length1":24,"length2":26}]],"length":15209,"saved":false}
{"ts":1353113683604,"patch":[[{"diffs":[[0,"e mix.\r\n"],[1,"// Express v3 really bit me on this one.\r\n\r\n"],[0,"//  // S"]],"start1":2140,"start2":2140,"length1":16,"length2":60},{"diffs":[[0,"s);\r"],[-1,"\n//app.dynamicHelpers(require(__dirname + 'locales.js').xlate);\r"],[0,"\n\r\n/"]],"start1":2299,"start2":2299,"length1":72,"length2":8}]],"length":15189,"saved":false}
{"ts":1353114377193,"patch":[[{"diffs":[[0,"    app."],[-1,"locals"],[1,"use"],[0,"(require"]],"start1":2510,"start2":2510,"length1":22,"length2":19}]],"length":15186,"saved":false}
{"ts":1353114869920,"patch":[[{"diffs":[[0,"yhel' }));\r\n"],[1,"  app.use(require(__dirname + '/helpers.js'));  \r\n"],[0,"  app.use(ap"]],"start1":1835,"start2":1835,"length1":24,"length2":74},{"diffs":[[0,"rs\r\n"],[-1,"    app.use(require(__dirname + '/helpers.js'));\r\n"],[0,"    "]],"start1":2556,"start2":2556,"length1":58,"length2":8}]],"length":15186,"saved":false}
{"ts":1353115033254,"patch":[[{"diffs":[[0,");\r\n"],[-1,"//  app.set('view options', { layout: false });\r\n\r\n// TODO: add dynamic and static helpers back into the mix.\r\n// Express v3 really bit me on this one.\r\n\r\n//  // Some dynamic view helpers\r\n//    app.dynamicHelpers(require(__dirname + '/helpers.js').dynamicHelpers);\r\n\r\n//    app.use(function(req, res, next) {\r\n//        var helpers = require(__dirname + '/helpers.js');\r\n//        app.locals(helpers.dynamicHelpers);\r\n//    });\r\n////  \r\n////  // some static view helpers\r\n    \r\n//    app.helpers(require(__dirname + '/locales.js'));\r\n"],[0,"    "]],"start1":2083,"start2":2083,"length1":543,"length2":8}]],"length":14651,"saved":false}
{"ts":1353436116965,"patch":[[{"diffs":[[0,"s.js'));"],[-1,"  "],[0,"\r\n  app."]],"start1":1885,"start2":1885,"length1":18,"length2":16}]],"length":14649,"saved":false}
{"ts":1353436136508,"patch":[[{"diffs":[[0,"ers.js'));\r\n"],[1,"  if (appSettings.helpers !== null && appSettings.helpers !== undefined) {\r\n      // some static view helpers\r\n      app.helpers(require(__dirname + appSettings.helpers));\r\n  }  \r\n"],[0,"  app.use(ap"]],"start1":1883,"start2":1883,"length1":24,"length2":204}]],"length":14829,"saved":false}
{"ts":1353436156388,"patch":[[{"diffs":[[0,");\r\n"],[-1,"  if (appSettings.helpers !== null && appSettings.helpers !== undefined) {\r\n      // some static view helpers\r\n      app.helpers(require(__dirname + appSettings.helpers));\r\n  }  "],[0,"\r\n  "]],"start1":1891,"start2":1891,"length1":186,"length2":8}]],"length":14651,"saved":false}
{"ts":1353436206441,"patch":[[{"diffs":[[0,";\r\n  }\r\n"],[1,"  \r\n  if (appSettings.helpers !== null && appSettings.helpers !== undefined) {\r\n    // some static view helpers\r\n    app.use(require(__dirname + appSettings.helpers));\r\n  }  "],[0,"\r\n//  if"]],"start1":3319,"start2":3319,"length1":16,"length2":190}]],"length":14825,"saved":false}
